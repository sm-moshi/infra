kubescape-operator:
  clusterName: lab
  ksNamespace: kubescape
  global:
    overrideRuntimePath: "/host/var/lib/rancher/k3s/data/current/bin/runc"
  capabilities:
    # Disable backend components for now: the Kubescape storage aggregated API
    # (APIService spdx.softwarecomposition.kubescape.io) can wedge ArgoCD and
    # even block kubescape namespace deletion when the storage service is down.
    #
    # This keeps the app safe to sync while we stabilize the cluster.
    backend-storage: enable
    operator: disable
    configurationScan: disable
    # Continuous scanning can create sustained API churn and resource pressure.
    # Keep it disabled for now; scheduled scans still provide posture coverage.
    continuousScan: disable
    nodeScan: disable
    # Reduce node-agent workload: SBOM generation is only needed for image vuln scanning.
    nodeSbomGeneration: disable
    # We only want posture/config scanning for now; disable image vulnerability scanning.
    vulnerabilityScan: disable
    # Relevancy is part of the vuln-scanning pipeline; disable alongside vulnerabilityScan.
    relevancy: disable
    runtimeObservability: disable
    runtimeDetection: disable
    malwareDetection: disable
    networkPolicyService: disable
    nodeProfileService: disable
    admissionController: disable
    httpDetection: disable
    seccompProfileService: disable
    autoUpgrading: disable
    prometheusExporter: disable

  # Avoid creating namespace-scoped Storage CA secrets when Storage is disabled.
  storage:
    mtls:
      enabled: false
  kubescape:
    resources:
      requests:
        cpu: 500m
        memory: 128Mi
      limits:
        cpu: 1
        memory: 256Mi

  # kubevuln defaults to 5Gi memory limit; that is unnecessary for our current
  # workload and can contribute to node pressure. Keep enough headroom for
  # image scans, but cap it below the upstream default.
  kubevuln:
    resources:
      requests:
        cpu: 300m
        memory: 1Gi
        ephemeral-storage: 5Gi
      limits:
        cpu: 1500m
        memory: 2Gi
        ephemeral-storage: 10Gi
  configurations:
    priorityClass:
      enabled: false
  resources:
    requests:
      cpu: 125m
      memory: 128Mi
    limits:
      cpu: 500m
      memory: 256Mi
