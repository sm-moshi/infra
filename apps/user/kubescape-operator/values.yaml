kubescape-operator:
  clusterName: lab
  ksNamespace: kubescape
  global:
    overrideRuntimePath: "/host/var/lib/rancher/k3s/data/current/bin/runc"
  capabilities:
    configurationScan: enable
    continuousScan: enable
    nodeScan: enable
    vulnerabilityScan: enable
    relevancy: enable
    runtimeObservability: disable
    runtimeDetection: disable
    malwareDetection: disable
    networkPolicyService: enable
    seccompProfileService: enable
    autoUpgrading: disable
    prometheusExporter: disable
  kubescape:
    resources:
      requests:
        cpu: 500m
        memory: 128Mi
      limits:
        cpu: 1
        memory: 256Mi

  # kubevuln defaults to 5Gi memory limit; that is unnecessary for our current
  # workload and can contribute to node pressure. Keep enough headroom for
  # image scans, but cap it below the upstream default.
  kubevuln:
    resources:
      requests:
        cpu: 300m
        memory: 1Gi
        ephemeral-storage: 5Gi
      limits:
        cpu: 1500m
        memory: 2Gi
        ephemeral-storage: 10Gi
  configurations:
    priorityClass:
      enabled: false
  resources:
    requests:
      cpu: 125m
      memory: 128Mi
    limits:
      cpu: 500m
      memory: 256Mi
