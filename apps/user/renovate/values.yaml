cronSchedule: "0 * * * *"

image:
  registry: ""
  repository: renovate/renovate
  tag: "43.0.10-full@sha256:fd1467a40be7ad1778aa5de1ed1e9b5785fbe19f1688897c538b6bf1ed02486c"
  pullPolicy: Always

# imagePullSecrets:
#   - harbor-robot-gitea

# hostAliases:
#   - ip: "10.43.175.100"
#     hostnames:
#       - harbor.m0sh1.cc

secretName: renovate-github-token

github:
  endpoint: https://api.github.com
  gitAuthor: "Renovate Bot <renovate@m0sh1.cc>"
  repositories: '["sm-moshi/infra", "sm-moshi/helm-charts", "sm-moshi/act"]'

logLevel: debug

podAnnotations:
  m0sh1.cc/restarted-at: "2025-12-27T01:15:00Z"

extraEnv:
  NODE_OPTIONS: "--max-old-space-size=3584"
  RENOVATE_CONCURRENT_LIMIT: "1"
  RENOVATE_WORKER_COUNT: "1"
  RENOVATE_CACHE_DIR: "/tmp/renovate-cache"

podSecurityContext:
  fsGroup: 1000
  fsGroupChangePolicy: "OnRootMismatch"

resources:
  requests:
    cpu: 200m
    memory: 512Mi
  limits:
    cpu: 2
    memory: 2Gi
tolerations: []
affinity:
  nodeAffinity:
    preferredDuringSchedulingIgnoredDuringExecution:
      - weight: 90
        preference:
          matchExpressions:
            - key: node-role.kubernetes.io/worker
              operator: Exists
      - weight: 80
        preference:
          matchExpressions:
            - key: topology.kubernetes.io/zone
              operator: In
              values: ["pve-01"]
      - weight: 60
        preference:
          matchExpressions:
            - key: topology.kubernetes.io/zone
              operator: In
              values: ["pve-02"]

persistence:
  cache:
    enabled: true
    storageClass: proxmox-csi-zfs-nvme-fast-retain
    storageSize: 5Gi
    accessModes:
      - ReadWriteOnce
    mountPath: /tmp/renovate-cache

# nodeSelector:
#   node-role.kubernetes.io/worker: "true"
# affinity:
#   nodeAffinity:
#     preferredDuringSchedulingIgnoredDuringExecution:
#       - weight: 50
#         preference:
#           matchExpressions:
#             - key: topology.kubernetes.io/zone
#               operator: In
#               values:
#                 - pve-01
# tolerations:
#   - key: node-role.kubernetes.io/control-plane
#     operator: Exists
#     effect: NoSchedule
