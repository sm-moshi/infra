rustfs:
  image:
    tag: "1.0.0-alpha.82"

  replicaCount: 1
  deploymentType: "deployment"

  auth:
    existingSecret: rustfs-root-credentials
    existingSecretAccessKeyKey: RUSTFS_ACCESS_KEY
    existingSecretSecretKeyKey: RUSTFS_SECRET_KEY

  config:
    volumes: "/data"
    address: "0.0.0.0:9000"
    consoleAddress: "0.0.0.0:9001"
    consoleEnabled: true
    externalAddress: ":443"
    corsAllowedOrigins: "https://s3.m0sh1.cc,https://s3-console.m0sh1.cc"
    consoleCorsAllowedOrigins: "https://s3-console.m0sh1.cc"
    logLevel: "info"
    extraEnvVars:
      - name: RUSTFS_REGION
        value: "us-east-1"
      - name: RUSTFS_DOMAINS
        value: "s3.m0sh1.cc"
      - name: RUSTFS_OBS_LOG_DIRECTORY
        value: "/logs"
      - name: RUSTFS_OBS_ENVIRONMENT
        value: "production"

  service:
    type: ClusterIP
    port: 9000
    consolePort: 9001

  ingress:
    enabled: true
    className: "traefik"
    annotations:
      traefik.ingress.kubernetes.io/router.entrypoints: websecure
      traefik.ingress.kubernetes.io/router.tls: "true"
      external-dns.alpha.kubernetes.io/ignore: "true"
    hosts:
      - host: s3.m0sh1.cc
        paths:
          - path: /
            pathType: Prefix
    tls:
      - secretName: wildcard-s3-m0sh1-cc
        hosts:
          - s3.m0sh1.cc

  consoleIngress:
    enabled: true
    className: "traefik"
    annotations:
      traefik.ingress.kubernetes.io/router.entrypoints: websecure
      traefik.ingress.kubernetes.io/router.tls: "true"
      external-dns.alpha.kubernetes.io/ignore: "true"
    hosts:
      - host: s3-console.m0sh1.cc
        paths:
          - path: /
            pathType: Prefix
    tls:
      - secretName: wildcard-s3-m0sh1-cc
        hosts:
          - s3-console.m0sh1.cc

  dataPersistence:
    enabled: true
    storageClass: proxmox-csi-zfs-sata-object-retain
    size: 75Gi
    accessModes:
      - ReadWriteOnce
    mountPath: /data

  logsPersistence:
    enabled: true
    storageClass: proxmox-csi-zfs-sata-general-retain
    size: 10Gi
    accessModes:
      - ReadWriteOnce
    mountPath: /logs

  resources:
    requests:
      memory: "512Mi"
      cpu: "250m"
    limits:
      memory: "2Gi"
      cpu: "1000m"

  podSecurityContext:
    fsGroup: 1001

  containerSecurityContext:
    allowPrivilegeEscalation: false
    runAsNonRoot: false
    runAsUser: 0
    runAsGroup: 0

  nodeSelector:
    node-role.kubernetes.io/worker: "true"
